<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Universal service-providers</title>

        <link rel="stylesheet" href="http://moufmouf.github.io/service-providers-best-practices/css/bootstrap.min.css">
        <!--<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">-->
        <link rel="stylesheet" href="http://moufmouf.github.io/service-providers-best-practices/css/main.css">
        <link rel='stylesheet' id='hljstheme-css'  href='http://moufmouf.github.io/service-providers-best-practices/components/highlightjs/styles/darkula.css' type='text/css' media='all' />

        <script src="https://code.jquery.com/jquery-1.12.3.min.js" integrity="sha256-aaODHAgvwQW1bFOGXMeX+pC4PZIPsvn2h1sArYOhgXQ=" crossorigin="anonymous"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type='text/javascript' src='http://moufmouf.github.io/service-providers-best-practices/components/highlightjs/highlight.pack.min.js'></script>

        <script>
            $(function() {
                // Little tweak for <h1>
                $("main > h1").wrap('<div class="page-header" />');
            });
        </script>

        <script type="text/javascript">
            (function($, window) {
                var init_fn_flag = false;
                var init_fn = (function() {
                    if (init_fn_flag)
                        return;
                    init_fn_flag = true;
                    hljs.configure({"tabReplace":"    "});
                    $('pre code').each(function(i, block) {
                        hljs.highlightBlock(block);
                    });
                });
                $(document).ready(init_fn);
                $(window).on("load", init_fn);
            })(jQuery, window);
        </script>

    </head>
    <body>

    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                        aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Universal service-providers</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><a href="http://moufmouf.github.io/service-providers-best-practices/">Home</a></li>
                    <li><a href="http://moufmouf.github.io/service-providers-best-practices/users.html">For users</a></li>
                    <li><a href="http://moufmouf.github.io/service-providers-best-practices/package_developers.html">For package developers</a></li>
                    <li><a href="http://moufmouf.github.io/service-providers-best-practices/framework_developers.html">For framework developers</a></li>
                    <!--<li class="dropdown">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>
                      <ul class="dropdown-menu">
                        <li><a href="#">Action</a></li>
                        <li><a href="#">Another action</a></li>
                        <li><a href="#">Something else here</a></li>
                        <li role="separator" class="divider"></li>
                        <li class="dropdown-header">Nav header</li>
                        <li><a href="#">Separated link</a></li>
                        <li><a href="#">One more separated link</a></li>
                      </ul>
                    </li>-->
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="#">About</a></li>
                </ul>
            </div><!--/.nav-collapse -->
        </div><!--/.container-fluid -->

    </nav>

    <div class="container">
                <script>
            $(function() {
                var jumboHeight = $('.jumbotron').outerHeight();
                function parallax(){
                    var scrolled = $(window).scrollTop();
                    $('.bg').css('height', (jumboHeight-scrolled) + 'px');
                }

                $(window).scroll(function(e){
                    parallax();
                });
                parallax();

            });
        </script>
        <div class="bg" style="background-image: url('images/bridge2.jpg')"></div>        <div class="jumbotron" >
            <h1>For framework and container developers</h1>
            <p class="lead">Making your project compatible with universal modules!</p>        </div>
        
        <p>So you are a framework developer or a container developer and are looking to add support for univeral modules in your project? Welcome!</p>
<h2 id="adding-support-for-service-providers">Adding support for service providers</h2>
<p>Essentially, adding support for universal modules means adding support for <a href="http://github.com/container-interop/service-provider">container-interop's service providers</a>.</p>
<p>There are essentially 2 strategies here:</p>
<ul>
<li>Add support for service providers in your container yourself,  </li>
<li>Or rely on a third party container and plug it into your container using the <a href="https://github.com/container-interop/container-interop/blob/master/docs/delegate-lookup.html">delegate lookup feature</a>.
<a href="https://github.com/thecodingmachine/yaco">Yaco</a> can be a good starting point to manage the entries provided by the service providers. It is a compiled container and yet is minimalistic.</li>
</ul>
<h2 id="the-container-contains-the-configuration">The container contains the configuration</h2>
<p>Configuration MUST be available from the container.</p>
<p>Each framework stores configuration in a different place.</p>
<ul>
<li>Symfony stores configuration in <code>app/config/config.yml</code>.</li>
<li>Laravel stores configuration in <code>config/app.php</code>.</li>
<li>Your framework may store it in another place...</li>
</ul>
<p>The only way to make configuration available in a framework agnostic way is to make it available in the container.</p>
<p>This means that <code>$container-&gt;get('DB_HOST')</code> should return the <code>DB_HOST</code> parameter stored in the configuration if it exists.</p>
<p>Many frameworks out there treat configuration and services as 2 different beasts and do not make configuration available in the container.
If you are in this case, you can still use universal module by providing the service providers with an adapter around your container.
The adapter will check both the container and the configuration.</p>
<p>Check the <a href="https://github.com/thecodingmachine/service-provider-bridge-bundle/blob/1.0/src/SymfonyContainerAdapter.php">Symfony adapter</a> or the <a href="https://github.com/thecodingmachine/laravel-universal-service-provider/blob/1.0/src/LaravelContainerAdapter.php">Laravel container adapter</a> if you need some examples.</p>
<h2 id="automatic-discovery-of-service-providers">Automatic discovery of service providers</h2>
<p>Frameworks MUST support service providers discovery using the Puli binding <strong>by default</strong>.</p>
<p>This way, users of your framework will just have to require the universal module in Composer and automatically, your framework will detect and embed the service provider in the container.</p>
<p>You should also offer an option to completely disable Puli.</p>
<p>Of course, users can also manually disable Puli bindings to remove one particular service provider.</p>
<h2 id="performance-optimizations">Performance optimizations</h2>
<p>TODO: explain integration with container-interop/common-factories</p>
    </div>


    </body>
</html>
